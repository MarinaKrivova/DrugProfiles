Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
2020-07-06 17:26:01 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Original dataset: (225384, 44)
2d filtration (Ensure that first and last points form plateus): Filtered dataset: (32974, 46)
3d stage filtration (Specified location of the plateus): Filtered dataset: (7947, 46)
  0%|          | 0/7947 [00:00<?, ?it/s]  1%|          | 42/7947 [00:00<00:19, 411.75it/s]  1%|          | 96/7947 [00:00<00:17, 442.68it/s]  2%|▏         | 150/7947 [00:00<00:16, 467.65it/s]  2%|▏         | 186/7947 [00:00<00:18, 427.78it/s]  3%|▎         | 226/7947 [00:00<00:18, 418.56it/s]  3%|▎         | 277/7947 [00:00<00:17, 440.98it/s]  4%|▍         | 332/7947 [00:00<00:16, 466.92it/s]  5%|▍         | 377/7947 [00:00<00:16, 445.38it/s]  5%|▌         | 430/7947 [00:00<00:16, 464.81it/s]  6%|▌         | 485/7947 [00:01<00:15, 486.30it/s]  7%|▋         | 534/7947 [00:01<00:16, 450.00it/s]  7%|▋         | 588/7947 [00:01<00:15, 473.51it/s]  8%|▊         | 636/7947 [00:01<00:18, 386.95it/s]  9%|▊         | 688/7947 [00:01<00:17, 417.47it/s]  9%|▉         | 743/7947 [00:01<00:16, 448.63it/s] 10%|▉         | 791/7947 [00:01<00:16, 434.25it/s] 11%|█         | 847/7947 [00:01<00:15, 465.27it/s] 11%|█▏        | 896/7947 [00:01<00:15, 441.28it/s] 12%|█▏        | 950/7947 [00:02<00:15, 464.91it/s] 13%|█▎        | 1002/7947 [00:02<00:14, 478.49it/s] 13%|█▎        | 1051/7947 [00:02<00:15, 449.64it/s] 14%|█▍        | 1105/7947 [00:02<00:14, 471.52it/s] 15%|█▍        | 1154/7947 [00:02<00:16, 421.43it/s] 15%|█▌        | 1198/7947 [00:02<00:16, 409.61it/s] 16%|█▌        | 1252/7947 [00:02<00:15, 439.85it/s] 16%|█▋        | 1305/7947 [00:02<00:14, 462.48it/s] 17%|█▋        | 1360/7947 [00:02<00:13, 482.60it/s] 18%|█▊        | 1413/7947 [00:03<00:13, 494.52it/s] 18%|█▊        | 1464/7947 [00:03<00:13, 466.36it/s] 19%|█▉        | 1512/7947 [00:03<00:14, 436.33it/s] 20%|█▉        | 1569/7947 [00:03<00:13, 467.78it/s] 20%|██        | 1618/7947 [00:03<00:13, 453.59it/s] 21%|██        | 1672/7947 [00:03<00:13, 474.69it/s] 22%|██▏       | 1722/7947 [00:03<00:12, 479.87it/s] 22%|██▏       | 1778/7947 [00:03<00:12, 500.65it/s] 23%|██▎       | 1834/7947 [00:03<00:11, 516.86it/s] 24%|██▎       | 1887/7947 [00:04<00:11, 515.99it/s] 24%|██▍       | 1944/7947 [00:04<00:11, 529.71it/s] 25%|██▌       | 2001/7947 [00:04<00:10, 541.01it/s] 26%|██▌       | 2056/7947 [00:04<00:11, 496.56it/s] 27%|██▋       | 2107/7947 [00:04<00:13, 429.40it/s] 27%|██▋       | 2159/7947 [00:04<00:12, 451.83it/s] 28%|██▊       | 2212/7947 [00:04<00:12, 471.64it/s] 29%|██▊       | 2267/7947 [00:04<00:11, 491.56it/s] 29%|██▉       | 2324/7947 [00:04<00:11, 510.86it/s] 30%|██▉       | 2377/7947 [00:05<00:11, 472.52it/s] 31%|███       | 2431/7947 [00:05<00:11, 489.90it/s] 31%|███       | 2483/7947 [00:05<00:10, 498.16it/s] 32%|███▏      | 2539/7947 [00:05<00:10, 513.65it/s] 33%|███▎      | 2594/7947 [00:05<00:10, 518.49it/s] 33%|███▎      | 2647/7947 [00:05<00:10, 512.23it/s] 34%|███▍      | 2700/7947 [00:05<00:10, 516.95it/s] 35%|███▍      | 2754/7947 [00:05<00:09, 521.99it/s] 35%|███▌      | 2808/7947 [00:05<00:09, 525.31it/s] 36%|███▌      | 2863/7947 [00:05<00:09, 530.53it/s] 37%|███▋      | 2917/7947 [00:06<00:11, 450.49it/s] 37%|███▋      | 2969/7947 [00:06<00:10, 467.74it/s] 38%|███▊      | 3026/7947 [00:06<00:09, 494.27it/s] 39%|███▊      | 3078/7947 [00:06<00:10, 475.71it/s] 39%|███▉      | 3127/7947 [00:06<00:10, 473.73it/s] 40%|████      | 3179/7947 [00:06<00:09, 485.25it/s] 41%|████      | 3234/7947 [00:06<00:09, 502.46it/s] 41%|████▏     | 3286/7947 [00:06<00:09, 507.08it/s] 42%|████▏     | 3341/7947 [00:06<00:08, 518.59it/s] 43%|████▎     | 3394/7947 [00:07<00:08, 511.55it/s] 43%|████▎     | 3451/7947 [00:07<00:08, 526.87it/s] 44%|████▍     | 3506/7947 [00:07<00:08, 532.73it/s] 45%|████▍     | 3560/7947 [00:07<00:08, 532.41it/s] 45%|████▌     | 3614/7947 [00:07<00:09, 480.40it/s] 46%|████▌     | 3667/7947 [00:07<00:08, 492.13it/s] 47%|████▋     | 3718/7947 [00:07<00:09, 453.85it/s] 47%|████▋     | 3773/7947 [00:07<00:08, 477.53it/s] 48%|████▊     | 3825/7947 [00:07<00:08, 489.25it/s] 49%|████▉     | 3877/7947 [00:08<00:08, 497.53it/s] 49%|████▉     | 3932/7947 [00:08<00:07, 510.19it/s] 50%|█████     | 3986/7947 [00:08<00:07, 516.77it/s] 51%|█████     | 4042/7947 [00:08<00:07, 526.30it/s] 52%|█████▏    | 4095/7947 [00:08<00:08, 452.36it/s] 52%|█████▏    | 4151/7947 [00:08<00:07, 478.08it/s] 53%|█████▎    | 4206/7947 [00:08<00:07, 496.43it/s] 54%|█████▎    | 4262/7947 [00:08<00:07, 512.51it/s] 54%|█████▍    | 4315/7947 [00:08<00:07, 486.94it/s] 55%|█████▍    | 4370/7947 [00:09<00:07, 503.37it/s] 56%|█████▌    | 4426/7947 [00:09<00:06, 518.57it/s] 56%|█████▋    | 4482/7947 [00:09<00:06, 529.75it/s] 57%|█████▋    | 4536/7947 [00:09<00:06, 525.61it/s] 58%|█████▊    | 4591/7947 [00:09<00:06, 530.76it/s] 58%|█████▊    | 4647/7947 [00:09<00:06, 537.95it/s] 59%|█████▉    | 4702/7947 [00:09<00:06, 525.57it/s] 60%|█████▉    | 4755/7947 [00:09<00:06, 509.99it/s] 60%|██████    | 4807/7947 [00:09<00:06, 504.08it/s] 61%|██████    | 4860/7947 [00:09<00:06, 510.74it/s] 62%|██████▏   | 4912/7947 [00:10<00:06, 470.11it/s] 62%|██████▏   | 4960/7947 [00:10<00:06, 447.39it/s] 63%|██████▎   | 5013/7947 [00:10<00:06, 467.38it/s] 64%|██████▎   | 5061/7947 [00:10<00:06, 415.77it/s] 64%|██████▍   | 5110/7947 [00:10<00:06, 433.41it/s] 65%|██████▍   | 5165/7947 [00:10<00:06, 462.38it/s] 66%|██████▌   | 5221/7947 [00:10<00:05, 486.50it/s] 66%|██████▋   | 5276/7947 [00:10<00:05, 502.96it/s] 67%|██████▋   | 5328/7947 [00:11<00:06, 433.76it/s] 68%|██████▊   | 5374/7947 [00:11<00:06, 385.04it/s] 68%|██████▊   | 5427/7947 [00:11<00:06, 419.07it/s] 69%|██████▉   | 5479/7947 [00:11<00:05, 416.63it/s] 69%|██████▉   | 5523/7947 [00:11<00:05, 408.99it/s] 70%|███████   | 5581/7947 [00:11<00:05, 448.14it/s] 71%|███████   | 5633/7947 [00:11<00:04, 466.54it/s] 72%|███████▏  | 5689/7947 [00:11<00:04, 490.86it/s] 72%|███████▏  | 5740/7947 [00:11<00:04, 459.36it/s] 73%|███████▎  | 5788/7947 [00:12<00:04, 444.19it/s] 73%|███████▎  | 5838/7947 [00:12<00:04, 454.44it/s] 74%|███████▍  | 5894/7947 [00:12<00:04, 479.75it/s] 75%|███████▍  | 5943/7947 [00:12<00:04, 477.76it/s] 75%|███████▌  | 5998/7947 [00:12<00:03, 496.64it/s] 76%|███████▌  | 6049/7947 [00:12<00:04, 455.39it/s] 77%|███████▋  | 6102/7947 [00:12<00:03, 474.84it/s] 77%|███████▋  | 6151/7947 [00:12<00:04, 447.93it/s] 78%|███████▊  | 6208/7947 [00:12<00:03, 477.01it/s] 79%|███████▉  | 6261/7947 [00:13<00:03, 488.97it/s] 79%|███████▉  | 6311/7947 [00:13<00:03, 463.57it/s] 80%|████████  | 6366/7947 [00:13<00:03, 482.27it/s] 81%|████████  | 6416/7947 [00:13<00:03, 447.61it/s] 81%|████████▏ | 6462/7947 [00:13<00:03, 428.80it/s] 82%|████████▏ | 6510/7947 [00:13<00:03, 420.76it/s] 83%|████████▎ | 6565/7947 [00:13<00:03, 451.29it/s] 83%|████████▎ | 6620/7947 [00:13<00:02, 475.96it/s] 84%|████████▍ | 6672/7947 [00:13<00:02, 487.08it/s] 85%|████████▍ | 6727/7947 [00:14<00:02, 503.74it/s] 85%|████████▌ | 6779/7947 [00:14<00:02, 508.22it/s] 86%|████████▌ | 6834/7947 [00:14<00:02, 517.73it/s] 87%|████████▋ | 6887/7947 [00:14<00:02, 521.12it/s] 87%|████████▋ | 6940/7947 [00:14<00:01, 517.47it/s] 88%|████████▊ | 6994/7947 [00:14<00:01, 520.72it/s] 89%|████████▊ | 7047/7947 [00:14<00:01, 480.93it/s] 89%|████████▉ | 7103/7947 [00:14<00:01, 500.30it/s] 90%|█████████ | 7154/7947 [00:14<00:01, 469.81it/s] 91%|█████████ | 7202/7947 [00:15<00:01, 457.60it/s] 91%|█████████▏| 7257/7947 [00:15<00:01, 480.42it/s] 92%|█████████▏| 7314/7947 [00:15<00:01, 502.52it/s] 93%|█████████▎| 7369/7947 [00:15<00:01, 514.36it/s] 93%|█████████▎| 7425/7947 [00:15<00:00, 524.34it/s] 94%|█████████▍| 7480/7947 [00:15<00:00, 531.67it/s] 95%|█████████▍| 7534/7947 [00:15<00:00, 491.73it/s] 95%|█████████▌| 7589/7947 [00:15<00:00, 507.46it/s] 96%|█████████▌| 7641/7947 [00:15<00:00, 445.38it/s] 97%|█████████▋| 7696/7947 [00:15<00:00, 471.68it/s] 97%|█████████▋| 7745/7947 [00:16<00:00, 434.30it/s] 98%|█████████▊| 7802/7947 [00:16<00:00, 466.30it/s] 99%|█████████▉| 7856/7947 [00:16<00:00, 484.21it/s]100%|█████████▉| 7912/7947 [00:16<00:00, 503.23it/s]100%|██████████| 7947/7947 [00:16<00:00, 481.75it/s]
Fitted data with removed unfit (7871, 48)
Unique drugs in the filterd data: 172
Number of drugs with more than 30 records: 49
Number of drugs with less than 10 records: 68
Number of drugs with only 1 record: 22
Linear kernel
best_linear_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

linear kernel, best values for parameter: alpha
{1: 7.0, 2: 7.0, 3: 7.0, 4: 7.0}
best_linear_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

linear kernel, best values for parameter: alpha
{1: 100.0, 2: 50.0, 3: 100.0, 4: 50.0}
best_linear_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

linear kernel, best values for parameter: alpha
{1: 100.0, 2: 50.0, 3: 100.0, 4: 50.0}

Sigmoid Kernel
best_sigmoid_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: gamma
{1: 0.01, 2: 0.01, 3: 0.01, 4: 0.01}
best_sigmoid_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: gamma
{1: 1e-04, 2: 1e-04, 3: 0.01, 4: 0.01}
best_sigmoid_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: alpha
{1: 0.1, 2: 0.1, 3: 1.0, 4: 1.0}
best_sigmoid_coef0
Tuning hyperparameter coef0
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: coef0
{1: 0.5, 2: 0.1, 3: 1.0, 4: 1.0}
best_sigmoid_coef0
Tuning hyperparameter coef0
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: coef0
{1: 1.0, 2: 1.0, 3: 1.0, 4: 1.0}
RBF kernel
best_rbf_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

rbf kernel, best values for parameter: gamma
{1: 1e-04, 2: 0.001, 3: 0.001, 4: 0.001}
best_rbf_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

rbf kernel, best values for parameter: alpha
{1: 1.0, 2: 1.0, 3: 1.0, 4: 1.0}

Polynomial Kernel
best_polynomial_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

polynomial kernel, best values for parameter: gamma
{1: 1e-04, 2: 1e-04, 3: 1e-04, 4: 1e-04}
best_polynomial_degree
Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
2020-07-06 18:38:06 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Original dataset: (225384, 44)
2d filtration (Ensure that first and last points form plateus): Filtered dataset: (32974, 46)
3d stage filtration (Specified location of the plateus): Filtered dataset: (7947, 46)
  0%|          | 0/7947 [00:00<?, ?it/s]  0%|          | 1/7947 [00:01<2:19:11,  1.05s/it]  0%|          | 34/7947 [00:01<1:37:09,  1.36it/s]  1%|          | 87/7947 [00:01<1:07:37,  1.94it/s]  2%|▏         | 146/7947 [00:01<47:02,  2.76it/s]   2%|▏         | 186/7947 [00:01<32:51,  3.94it/s]  3%|▎         | 229/7947 [00:01<22:58,  5.60it/s]  4%|▎         | 285/7947 [00:01<16:01,  7.97it/s]  4%|▍         | 343/7947 [00:01<11:12, 11.31it/s]  5%|▍         | 390/7947 [00:01<07:52, 15.98it/s]  6%|▌         | 445/7947 [00:01<05:32, 22.55it/s]  6%|▋         | 502/7947 [00:02<03:55, 31.67it/s]  7%|▋         | 553/7947 [00:02<02:48, 43.86it/s]  8%|▊         | 602/7947 [00:02<02:02, 60.05it/s]  8%|▊         | 649/7947 [00:02<01:31, 79.91it/s]  9%|▉         | 704/7947 [00:02<01:07, 107.39it/s]  9%|▉         | 752/7947 [00:02<00:51, 139.08it/s] 10%|█         | 808/7947 [00:02<00:39, 179.55it/s] 11%|█         | 866/7947 [00:02<00:31, 226.17it/s] 12%|█▏        | 918/7947 [00:02<00:26, 264.91it/s] 12%|█▏        | 973/7947 [00:03<00:22, 313.14it/s] 13%|█▎        | 1029/7947 [00:03<00:19, 359.93it/s] 14%|█▎        | 1082/7947 [00:03<00:17, 381.69it/s] 14%|█▍        | 1132/7947 [00:03<00:17, 397.94it/s] 15%|█▍        | 1181/7947 [00:03<00:17, 386.65it/s] 16%|█▌        | 1235/7947 [00:03<00:15, 421.40it/s] 16%|█▋        | 1292/7947 [00:03<00:14, 456.66it/s] 17%|█▋        | 1349/7947 [00:03<00:13, 484.92it/s] 18%|█▊        | 1405/7947 [00:03<00:12, 504.90it/s] 18%|█▊        | 1459/7947 [00:04<00:13, 484.60it/s] 19%|█▉        | 1510/7947 [00:04<00:13, 461.03it/s] 20%|█▉        | 1570/7947 [00:04<00:12, 494.42it/s] 20%|██        | 1622/7947 [00:04<00:13, 482.47it/s] 21%|██        | 1678/7947 [00:04<00:12, 502.01it/s] 22%|██▏       | 1734/7947 [00:04<00:12, 515.74it/s] 23%|██▎       | 1794/7947 [00:04<00:11, 536.68it/s] 23%|██▎       | 1853/7947 [00:04<00:11, 546.40it/s] 24%|██▍       | 1909/7947 [00:04<00:10, 550.00it/s] 25%|██▍       | 1969/7947 [00:05<00:10, 563.39it/s] 26%|██▌       | 2028/7947 [00:05<00:10, 568.19it/s] 26%|██▌       | 2086/7947 [00:05<00:11, 492.28it/s] 27%|██▋       | 2138/7947 [00:05<00:12, 474.28it/s] 28%|██▊       | 2193/7947 [00:05<00:11, 493.17it/s] 28%|██▊       | 2251/7947 [00:05<00:11, 514.54it/s] 29%|██▉       | 2311/7947 [00:05<00:10, 535.19it/s] 30%|██▉       | 2366/7947 [00:05<00:11, 501.09it/s] 30%|███       | 2423/7947 [00:05<00:10, 519.49it/s] 31%|███       | 2479/7947 [00:06<00:10, 530.28it/s] 32%|███▏      | 2538/7947 [00:06<00:09, 546.83it/s] 33%|███▎      | 2595/7947 [00:06<00:09, 551.87it/s] 33%|███▎      | 2651/7947 [00:06<00:09, 548.20it/s] 34%|███▍      | 2707/7947 [00:06<00:09, 549.49it/s] 35%|███▍      | 2765/7947 [00:06<00:09, 556.05it/s] 35%|███▌      | 2821/7947 [00:06<00:13, 371.56it/s] 36%|███▌      | 2867/7947 [00:07<00:17, 290.97it/s] 37%|███▋      | 2905/7947 [00:07<00:17, 296.15it/s] 37%|███▋      | 2961/7947 [00:07<00:14, 344.38it/s] 38%|███▊      | 3021/7947 [00:07<00:12, 394.55it/s] 39%|███▊      | 3069/7947 [00:07<00:11, 410.59it/s] 39%|███▉      | 3122/7947 [00:07<00:10, 439.98it/s] 40%|███▉      | 3175/7947 [00:07<00:10, 462.71it/s] 41%|████      | 3234/7947 [00:07<00:09, 492.97it/s] 41%|████▏     | 3289/7947 [00:07<00:09, 508.74it/s] 42%|████▏     | 3346/7947 [00:07<00:08, 525.31it/s] 43%|████▎     | 3401/7947 [00:08<00:08, 531.41it/s] 44%|████▎     | 3462/7947 [00:08<00:08, 550.61it/s] 44%|████▍     | 3519/7947 [00:08<00:08, 551.14it/s] 45%|████▍     | 3575/7947 [00:08<00:08, 520.95it/s] 46%|████▌     | 3628/7947 [00:08<00:08, 520.18it/s] 46%|████▋     | 3685/7947 [00:08<00:08, 532.69it/s] 47%|████▋     | 3739/7947 [00:08<00:08, 488.93it/s] 48%|████▊     | 3795/7947 [00:08<00:08, 506.41it/s] 48%|████▊     | 3851/7947 [00:08<00:07, 520.20it/s] 49%|████▉     | 3910/7947 [00:09<00:07, 538.74it/s] 50%|████▉     | 3968/7947 [00:09<00:07, 548.36it/s] 51%|█████     | 4026/7947 [00:09<00:07, 556.38it/s] 51%|█████▏    | 4083/7947 [00:09<00:07, 485.61it/s] 52%|█████▏    | 4144/7947 [00:09<00:07, 515.10it/s] 53%|█████▎    | 4201/7947 [00:09<00:07, 529.79it/s] 54%|█████▎    | 4259/7947 [00:09<00:06, 542.16it/s] 54%|█████▍    | 4315/7947 [00:09<00:06, 519.89it/s] 55%|█████▌    | 4374/7947 [00:09<00:06, 537.01it/s] 56%|█████▌    | 4434/7947 [00:09<00:06, 552.36it/s] 57%|█████▋    | 4493/7947 [00:10<00:06, 560.80it/s] 57%|█████▋    | 4550/7947 [00:10<00:06, 557.60it/s] 58%|█████▊    | 4611/7947 [00:10<00:05, 570.14it/s] 59%|█████▉    | 4669/7947 [00:10<00:05, 568.58it/s] 59%|█████▉    | 4727/7947 [00:10<00:05, 560.42it/s] 60%|██████    | 4784/7947 [00:10<00:05, 536.44it/s] 61%|██████    | 4842/7947 [00:10<00:05, 546.73it/s] 62%|██████▏   | 4897/7947 [00:10<00:06, 507.26it/s] 62%|██████▏   | 4949/7947 [00:10<00:06, 486.18it/s] 63%|██████▎   | 5006/7947 [00:11<00:05, 506.72it/s] 64%|██████▎   | 5058/7947 [00:11<00:06, 454.42it/s] 64%|██████▍   | 5112/7947 [00:11<00:05, 475.43it/s] 65%|██████▌   | 5171/7947 [00:11<00:05, 504.39it/s] 66%|██████▌   | 5230/7947 [00:11<00:05, 525.65it/s] 66%|██████▋   | 5284/7947 [00:11<00:05, 500.87it/s] 67%|██████▋   | 5336/7947 [00:11<00:05, 477.55it/s] 68%|██████▊   | 5385/7947 [00:11<00:05, 428.25it/s] 68%|██████▊   | 5442/7947 [00:12<00:05, 460.86it/s] 69%|██████▉   | 5490/7947 [00:12<00:05, 451.30it/s] 70%|██████▉   | 5537/7947 [00:12<00:05, 448.50it/s] 70%|███████   | 5598/7947 [00:12<00:04, 485.52it/s] 71%|███████   | 5656/7947 [00:12<00:04, 505.58it/s] 72%|███████▏  | 5710/7947 [00:12<00:04, 488.96it/s] 73%|███████▎  | 5767/7947 [00:12<00:04, 510.50it/s] 73%|███████▎  | 5820/7947 [00:12<00:04, 482.11it/s] 74%|███████▍  | 5876/7947 [00:12<00:04, 502.99it/s] 75%|███████▍  | 5931/7947 [00:12<00:03, 514.94it/s] 75%|███████▌  | 5987/7947 [00:13<00:03, 525.80it/s] 76%|███████▌  | 6041/7947 [00:13<00:03, 499.87it/s] 77%|███████▋  | 6097/7947 [00:13<00:03, 516.13it/s] 77%|███████▋  | 6150/7947 [00:13<00:03, 485.13it/s] 78%|███████▊  | 6210/7947 [00:13<00:03, 514.16it/s] 79%|███████▉  | 6267/7947 [00:13<00:03, 527.41it/s] 80%|███████▉  | 6321/7947 [00:13<00:03, 502.65it/s] 80%|████████  | 6378/7947 [00:13<00:03, 519.20it/s] 81%|████████  | 6431/7947 [00:13<00:03, 485.01it/s] 82%|████████▏ | 6481/7947 [00:14<00:03, 466.03it/s] 82%|████████▏ | 6529/7947 [00:14<00:03, 457.66it/s] 83%|████████▎ | 6589/7947 [00:14<00:02, 491.31it/s] 84%|████████▎ | 6645/7947 [00:14<00:02, 510.03it/s] 84%|████████▍ | 6702/7947 [00:14<00:02, 525.42it/s] 85%|████████▌ | 6761/7947 [00:14<00:02, 542.21it/s] 86%|████████▌ | 6817/7947 [00:14<00:02, 545.42it/s] 87%|████████▋ | 6875/7947 [00:14<00:01, 554.30it/s] 87%|████████▋ | 6932/7947 [00:14<00:01, 557.38it/s] 88%|████████▊ | 6989/7947 [00:15<00:01, 552.77it/s] 89%|████████▊ | 7045/7947 [00:15<00:01, 518.13it/s] 89%|████████▉ | 7105/7947 [00:15<00:01, 538.59it/s] 90%|█████████ | 7160/7947 [00:15<00:01, 475.02it/s] 91%|█████████ | 7221/7947 [00:15<00:01, 508.41it/s] 92%|█████████▏| 7281/7947 [00:15<00:01, 532.45it/s] 92%|█████████▏| 7339/7947 [00:15<00:01, 545.14it/s] 93%|█████████▎| 7398/7947 [00:15<00:00, 556.19it/s] 94%|█████████▍| 7458/7947 [00:15<00:00, 566.44it/s] 95%|█████████▍| 7516/7947 [00:16<00:00, 529.97it/s] 95%|█████████▌| 7575/7947 [00:16<00:00, 543.50it/s] 96%|█████████▌| 7631/7947 [00:16<00:00, 519.23it/s] 97%|█████████▋| 7684/7947 [00:16<00:00, 497.91it/s] 97%|█████████▋| 7735/7947 [00:16<00:00, 470.40it/s] 98%|█████████▊| 7792/7947 [00:16<00:00, 495.33it/s] 99%|█████████▉| 7849/7947 [00:16<00:00, 513.81it/s]100%|█████████▉| 7909/7947 [00:16<00:00, 536.01it/s]100%|██████████| 7947/7947 [00:16<00:00, 472.13it/s]
Fitted data with removed unfit (7871, 48)
Unique drugs in the filterd data: 172
Number of drugs with more than 30 records: 49
Number of drugs with less than 10 records: 68
Number of drugs with only 1 record: 22
Linear kernel
best_linear_alpha
                                                                                                                                                                                          Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

linear kernel, best values for parameter: alpha
{1: 7.0, 2: 7.0, 3: 7.0, 4: 7.0}
best_linear_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

linear kernel, best values for parameter: alpha
{1: 100.0, 2: 50.0, 3: 100.0, 4: 50.0}
best_linear_alpha
                                                                                                                                                                                                                   Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

linear kernel, best values for parameter: alpha
{1: 100.0, 2: 50.0, 3: 100.0, 4: 50.0}

Sigmoid Kernel
best_sigmoid_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: gamma
{1: 0.01, 2: 0.01, 3: 0.01, 4: 0.01}
best_sigmoid_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: gamma
{1: 1e-04, 2: 1e-04, 3: 0.01, 4: 0.01}
best_sigmoid_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: alpha
{1: 0.1, 2: 0.1, 3: 1.0, 4: 1.0}
best_sigmoid_coef0
Tuning hyperparameter coef0
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: coef0
{1: 0.5, 2: 0.1, 3: 1.0, 4: 1.0}
best_sigmoid_coef0
Tuning hyperparameter coef0
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

sigmoid kernel, best values for parameter: coef0
{1: 1.0, 2: 1.0, 3: 1.0, 4: 1.0}
RBF kernel
best_rbf_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

rbf kernel, best values for parameter: gamma
{1: 1e-04, 2: 0.001, 3: 0.001, 4: 0.001}
best_rbf_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

rbf kernel, best values for parameter: alpha
{1: 1.0, 2: 1.0, 3: 1.0, 4: 1.0}

Polynomial Kernel
best_polynomial_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

polynomial kernel, best values for parameter: gamma
{1: 1e-04, 2: 1e-04, 3: 1e-04, 4: 1e-04}
best_polynomial_degree
Tuning hyperparameter degree
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

polynomial kernel, best values for parameter: degree
{1: 5.0, 2: 5.0, 3: 5.0, 4: 5.0}
best_polynomial_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

polynomial kernel, best values for parameter: alpha
{1: 0.1, 2: 0.1, 3: 0.01, 4: 0.01}

additive_chi2 kernel
best_additive_chi2_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

additive_chi2 kernel, best values for parameter: gamma
{1: 1e-05, 2: 1e-05, 3: 1e-05, 4: 1e-05}
best_additive_chi2_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

additive_chi2 kernel, best values for parameter: alpha
{1: 5.0, 2: 5.0, 3: 5.0, 4: 5.0}

Laplacian Kernel
best_laplacian_gamma
Tuning hyperparameter gamma
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

laplacian kernel, best values for parameter: gamma
{1: 1e-04, 2: 1e-04, 3: 1e-04, 4: 1e-04}
best_laplacian_alpha
Tuning hyperparameter alpha
x0, L, k, b   y = 1/ (L + np.exp(-k*(x-x0)))+b 

laplacian kernel, best values for parameter: alpha
{1: 1.0, 2: 0.1, 3: 0.1, 4: 0.1}

Training and testing Kernels with best parameter
         linear    sigmoid        rbf  polynomial  additive_chi2  laplacian
mean   1.275999   1.216699   1.215860    1.215522       1.517045   1.215860
min    0.025346   0.004227   0.004295    0.004264       0.006004   0.004295
max   15.720624  16.884999  16.864686   16.861343      21.145421  16.864686
Coefficient: 1, best kernel: polynomial
           linear      sigmoid  ...  additive_chi2    laplacian
mean    25.166303    24.576230  ...      25.406647    24.583159
min      0.085108     0.004767  ...       0.004825     0.004735
max   1031.117851  1017.530840  ...    1017.792779  1017.442190

[3 rows x 6 columns]
Coefficient: 2, best kernel: sigmoid
           linear      sigmoid  ...  additive_chi2    laplacian
mean  1761.872396  1556.784223  ...    2229.535577  1559.560965
min     38.490102     7.697322  ...      16.014468     7.302185
max   7849.114113  6318.767426  ...    9316.788412  6293.082389

[3 rows x 6 columns]
Coefficient: 3, best kernel: sigmoid
        linear   sigmoid       rbf  polynomial  additive_chi2  laplacian
mean  0.033140  0.031870  0.032019    0.032152       0.036770   0.031977
min   0.001548  0.001154  0.001113    0.001097       0.003134   0.001118
max   0.256113  0.273612  0.274941    0.275011       0.256094   0.275500
Coefficient: 4, best kernel: sigmoid

Best Kernels
{1: 'polynomial', 2: 'sigmoid', 3: 'sigmoid', 4: 'sigmoid'}
2020-07-06 23:07:02 INFO  ShutdownHookManager:54 - Shutdown hook called
2020-07-06 23:07:02 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-6ad79406-75aa-4715-959e-20f977243727
